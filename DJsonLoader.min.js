/*
 *DJsonLoader v1.1.0
 * Copyright (C) 2019 David Esneyder Jerez Garnica
 * esneyderg357@gmail.com
 * https://github.com/esneyderg357/DJsonLoader.git
 */
if("undefined"==typeof jQuery)throw new Error("DJsonLoader requires jQuery 1.11.1 or higher.");!function(c){var l={reset:!1,resetString:"",slabel:"",svalue:"",sselected:"",sempty:!1,selabel:"select an option...",sevalue:"",Adata:[],ajax:!1,url:"",data:{},method:"post",onLoad:function(){},onReset:function(){},onError:function(){}};function i(e,a){switch(Array.isArray(a)||(a=String(a)),e.prop("tagName").toLowerCase()){case"input":switch(e.attr("type").toLowerCase()){case"radio":e.val()==a&&e.prop("checked","checked");break;case"checkbox":1==a||"true"==a?e.prop("checked","checked"):e.removeAttr("checked");break;default:e.val(a)}break;case"textarea":case"select":e.val(a);break;case"a":e.attr("href",a);break;case"img":case"iframe":e.attr("src",a);break;case"ul":case"ol":var t="";if(Array.isArray(a)&&0<a.length)for(var r=0;r<a.length;r++)t+="<li>"+a[r]+"</li>";else t+="<li>"+a+"</li>";e.html(t);break;default:e.html(a)}}function d(e,a,t){if("select"==a)return e.html(""),void t.onReset(e);"form"==a&&e[0].reset();for(var r=e.find("[data-djload]"),o=0;o<r.length;o++){var n=c(r[o]);switch((a=n.prop("tagName")).toLowerCase()){case"input":case"textarea":case"select":n.val("");break;case"a":n.attr("href","#");break;case"img":case"iframe":n.attr("src","");break;default:n.html(t.resetString)}}t.onReset(e)}function f(e,a,t){var r=c(a),o=r.prop("tagName").toLowerCase();"string"==typeof t&&(t=JSON.parse(t)),1==e.reset&&d(r,o,e),"select"==o?function(e,a,t){if(!Array.isArray(a))throw new Error("Data required for load select must be array.");var r="";if(1==t.sempty&&(r+='<option value="'+t.sevalue+'" selected>'+t.selabel+"</option>"),0<a.length)if("object"==typeof a[0])for(var o=""!=t.sselected,n=0;n<a.length;n++){for(var s=o&&a[n][t.sselected]?" selected ":"",l="",c=0;c<t.Adata.length;c++)l+=" data-"+t.Adata[c]+'="'+a[n][t.Adata[c]]+'" ';r+='<option value="'+a[n][t.svalue]+'" '+l+s+" >"+a[n][t.slabel]+"</option>"}else for(n=0;n<a.length;n++)r+='<option value="'+a[n]+'">'+a[n]+"</option>";e.html(r)}(r,t,e):function s(l,e){null!=e&&null!=e&&c.each(e,function(e,a){var t=typeof a,r=Array.isArray(a);if("object"!=t||r)for(var o=l.find("[name='"+e+"']").add(l.find("."+e)).add(l.find("[data-djload='"+e+"']")),n=0;n<o.length;n++)i(c(o[n]),a);else s(l,a)})}(r,t),e.onLoad(r)}c.fn.djload=function(n,e){var s=c.extend({},l,e);return"reset"==n?this.each(function(e,a){var t=c(a).prop("tagName").toLowerCase();d(c(a),t,s)}):"options"!=n?this.each(function(e,a){var t,r,o;s.ajax?(t=s,r=a,o=c.extend({},l,t),c.ajax({url:o.url,type:o.method,dataType:"json",data:o.data,cache:!1}).done(function(e){f(o,r,e.data)}).fail(function(e){console.log("ajax load error."),o.onError(e)})):f(s,a,n)}):void c.extend(l,e)}}(jQuery);